# üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –í–µ–∫—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω–æ–≥–æ –ë—ç–∫—Ç–µ—Å—Ç–∏–Ω–≥–∞

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞

```bash
start_server.bat
```

–°–µ—Ä–≤–µ—Ä –∑–∞–ø—É—Å—Ç–∏—Ç—Å—è –Ω–∞ http://127.0.0.1:8000

### 2. –û—Ç–∫—Ä—ã—Ç—å Swagger UI

–ü–µ—Ä–µ–π—Ç–∏ –≤ –±—Ä–∞—É–∑–µ—Ä–µ: http://127.0.0.1:8000/docs

### 3. –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è

1. –ù–∞–∂–∞—Ç—å –∫–Ω–æ–ø–∫—É "Authorize" (–∑–∞–º–æ–∫ —Å–ø—Ä–∞–≤–∞ –≤–≤–µ—Ä—Ö—É)
2. –í–≤–µ—Å—Ç–∏ X-API-Key (–∏–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –æ–∫—Ä—É–∂–µ–Ω–∏—è API_KEY)
3. –ù–∞–∂–∞—Ç—å "Authorize"

---

## –ü—Ä–∏–º–µ—Ä—ã –∑–∞–ø—Ä–æ—Å–æ–≤

### POST /backtest/run - –ó–∞–ø—É—Å–∫ –±—ç–∫—Ç–µ—Å—Ç–∞

**–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –∑–∞–ø—Ä–æ—Å:**

```json
{
  "exchange": "bybit",
  "symbol": "BTC/USDT",
  "timeframe": "1h",
  "start_date": "2024-01-01",
  "end_date": "2025-01-01"
}
```

**–ü–æ–ª–Ω—ã–π –∑–∞–ø—Ä–æ—Å —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏:**

```json
{
  "exchange": "bybit",
  "symbol": "BTC/USDT",
  "timeframe": "1h",
  "start_date": "2024-01-01",
  "end_date": "2025-01-01",
  "model_path": null,
  "signal_threshold": 0.6,
  "initial_capital": 1000.0,
  "commission_bps": 8.0,
  "slippage_bps": 5.0,
  "latency_bars": 1,
  "position_size": 1.0
}
```

**–û–∂–∏–¥–∞–µ–º—ã–π –æ—Ç–≤–µ—Ç:**

```json
{
  "success": true,
  "run_id": "backtest_20251010_233045",
  "metrics": {
    "total_return": 0.156,
    "sharpe_ratio": 1.82,
    "sortino_ratio": 2.45,
    "calmar_ratio": 0.95,
    "max_drawdown": -0.164,
    "max_drawdown_duration": 45,
    "max_recovery_time": 67,
    "current_drawdown": -0.023,
    "win_rate": 0.58,
    "avg_win": 0.032,
    "avg_loss": -0.018,
    "profit_factor": 1.84,
    "exposure_time": 0.45,
    "total_trades": 89,
    "benchmark_return": 0.124,
    "excess_return": 0.032
  },
  "equity_curve": [...],
  "trades": [...],
  "benchmark": {
    "benchmark_return": 0.124,
    "benchmark_sharpe": 1.12,
    "benchmark_max_dd": -0.185,
    "outperformance": 0.032,
    "beats_benchmark": true
  }
}
```

### GET /backtest/list - –°–ø–∏—Å–æ–∫ –±—ç–∫—Ç–µ—Å—Ç–æ–≤

**–ó–∞–ø—Ä–æ—Å:**

```
GET /backtest/list?limit=10
```

**–û—Ç–≤–µ—Ç:**

```json
{
  "backtests": [
    {
      "run_id": "backtest_20251010_233045",
      "timestamp": "20251010_233045",
      "metrics": {
        "total_return": 0.156,
        "sharpe_ratio": 1.82,
        "max_drawdown": -0.164,
        "win_rate": 0.58,
        "total_trades": 89
      },
      "config": {...}
    }
  ],
  "total": 1
}
```

### GET /backtest/compare - –°—Ä–∞–≤–Ω–∏—Ç—å –±—ç–∫—Ç–µ—Å—Ç—ã

**–ó–∞–ø—Ä–æ—Å:**

```
GET /backtest/compare?run_ids=backtest_20251010_233045,backtest_20251010_234521
```

**–û—Ç–≤–µ—Ç:**

```json
{
  "comparison": [
    {
      "run_id": "backtest_20251010_233045",
      "total_return": 0.156,
      "sharpe_ratio": 1.82,
      "sortino_ratio": 2.45,
      ...
    },
    {
      "run_id": "backtest_20251010_234521",
      "total_return": 0.142,
      "sharpe_ratio": 1.65,
      ...
    }
  ],
  "best": {
    "total_return": "backtest_20251010_233045",
    "sharpe_ratio": "backtest_20251010_233045",
    "sortino_ratio": "backtest_20251010_233045",
    ...
  },
  "count": 2
}
```

---

## –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è –º–µ—Ç—Ä–∏–∫

### –ö—Ä–∏—Ç–µ—Ä–∏–∏ —É—Å–ø–µ—Ö–∞

‚úÖ **–•–æ—Ä–æ—à–∞—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è:**
- Sharpe Ratio > 1.5
- Max Drawdown < 20% (> -0.20)
- Win Rate > 55% (> 0.55)
- Outperforms buy-and-hold (excess_return > 0)

‚ö†Ô∏è **–°—Ä–µ–¥–Ω—è—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è:**
- Sharpe Ratio: 1.0 - 1.5
- Max Drawdown: 20-30%
- Win Rate: 50-55%
- Close to buy-and-hold

‚ùå **–ü–ª–æ—Ö–∞—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è:**
- Sharpe Ratio < 1.0
- Max Drawdown > 30%
- Win Rate < 50%
- Underperforms buy-and-hold

### –û–ø–∏—Å–∞–Ω–∏–µ –º–µ—Ç—Ä–∏–∫

**Total Return** - –û–±—â–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å (0.156 = +15.6%)

**Sharpe Ratio** - Risk-adjusted returns (—É—á–∏—Ç—ã–≤–∞–µ—Ç –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å)
- > 1.5: –æ—Ç–ª–∏—á–Ω–æ
- 1.0-1.5: —Ö–æ—Ä–æ—à–æ
- 0.5-1.0: —Å—Ä–µ–¥–Ω–µ
- < 0.5: –ø–ª–æ—Ö–æ

**Sortino Ratio** - –¢–æ –∂–µ —á—Ç–æ Sharpe, –Ω–æ —É—á–∏—Ç—ã–≤–∞–µ—Ç —Ç–æ–ª—å–∫–æ –Ω–µ–≥–∞—Ç–∏–≤–Ω—É—é –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å

**Calmar Ratio** - –î–æ—Ö–æ–¥–Ω–æ—Å—Ç—å / –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø—Ä–æ—Å–∞–¥–∫–∞

**Max Drawdown** - –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø—Ä–æ—Å–∞–¥–∫–∞ –æ—Ç –ø–∏–∫–∞ (-0.164 = -16.4%)

**Win Rate** - –î–æ–ª—è –ø—Ä–∏–±—ã–ª—å–Ω—ã—Ö —Å–¥–µ–ª–æ–∫ (0.58 = 58%)

**Profit Factor** - –û—Ç–Ω–æ—à–µ–Ω–∏–µ –ø—Ä–∏–±—ã–ª–∏ –∫ —É–±—ã—Ç–∫–∞–º (1.84 = –Ω–∞ –∫–∞–∂–¥—ã–π $1 —É–±—ã—Ç–∫–∞ $1.84 –ø—Ä–∏–±—ã–ª–∏)

**Exposure Time** - –î–æ–ª—è –≤—Ä–µ–º–µ–Ω–∏ –≤ –ø–æ–∑–∏—Ü–∏–∏ (0.45 = 45% –≤—Ä–µ–º–µ–Ω–∏ –≤ —Ä—ã–Ω–∫–µ)

---

## –¢–µ—Å—Ç–æ–≤—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏

### –°—Ü–µ–Ω–∞—Ä–∏–π 1: –ë–∞–∑–æ–≤—ã–π –±—ç–∫—Ç–µ—Å—Ç –Ω–∞ BTC/USDT

```json
{
  "exchange": "bybit",
  "symbol": "BTC/USDT",
  "timeframe": "1h",
  "start_date": "2024-01-01",
  "end_date": "2025-01-01",
  "initial_capital": 1000.0
}
```

**–ß—Ç–æ –ø—Ä–æ–≤–µ—Ä—è–µ–º:**
- –†–∞–±–æ—Ç–∞–µ—Ç –ª–∏ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –¥–∞—Ç–∞—Å–µ—Ç–∞
- –ó–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –ª–∏ –º–æ–¥–µ–ª—å
- –ö–æ—Ä—Ä–µ–∫—Ç–Ω—ã –ª–∏ –º–µ—Ç—Ä–∏–∫–∏
- –ü—Ä–µ–≤–æ—Å—Ö–æ–¥–∏–º –ª–∏ buy-and-hold

### –°—Ü–µ–Ω–∞—Ä–∏–π 2: –í—ã—Å–æ–∫–∏–π –ø–æ—Ä–æ–≥ —Å–∏–≥–Ω–∞–ª–∞

```json
{
  "exchange": "bybit",
  "symbol": "BTC/USDT",
  "timeframe": "1h",
  "start_date": "2024-01-01",
  "end_date": "2025-01-01",
  "signal_threshold": 0.7,
  "initial_capital": 1000.0
}
```

**–û–∂–∏–¥–∞–Ω–∏–µ:**
- –ú–µ–Ω—å—à–µ —Å–¥–µ–ª–æ–∫ (total_trades)
- –í—ã—à–µ win_rate
- –ú–µ–Ω—å—à–µ exposure_time

### –°—Ü–µ–Ω–∞—Ä–∏–π 3: –í—ã—Å–æ–∫–∏–µ –∫–æ–º–∏—Å—Å–∏–∏ (—Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω—ã–π worst-case)

```json
{
  "exchange": "bybit",
  "symbol": "BTC/USDT",
  "timeframe": "1h",
  "start_date": "2024-01-01",
  "end_date": "2025-01-01",
  "commission_bps": 15.0,
  "slippage_bps": 10.0,
  "initial_capital": 1000.0
}
```

**–û–∂–∏–¥–∞–Ω–∏–µ:**
- –ù–∏–∂–µ total_return
- –ù–∏–∂–µ sharpe_ratio
- –ü—Ä–æ–≤–µ—Ä—è–µ–º —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å –∫ –∏–∑–¥–µ—Ä–∂–∫–∞–º

### –°—Ü–µ–Ω–∞—Ä–∏–π 4: –ß–∞—Å—Ç–∏—á–Ω–∞—è –ø–æ–∑–∏—Ü–∏—è (50% –∫–∞–ø–∏—Ç–∞–ª–∞)

```json
{
  "exchange": "bybit",
  "symbol": "BTC/USDT",
  "timeframe": "1h",
  "start_date": "2024-01-01",
  "end_date": "2025-01-01",
  "position_size": 0.5,
  "initial_capital": 1000.0
}
```

**–û–∂–∏–¥–∞–Ω–∏–µ:**
- –ù–∏–∂–µ total_return (–º–µ–Ω—å—à–µ —Ä–∏—Å–∫–∞)
- –í—ã—à–µ sharpe_ratio (–ª—É—á—à–µ risk-adjusted)
- –ù–∏–∂–µ max_drawdown (–º–µ–Ω—å—à–µ –ø—Ä–æ—Å–∞–¥–∫–∏)

---

## –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –û—à–∏–±–∫–∞: "Empty dataset"

**–ü—Ä–∏—á–∏–Ω–∞:** –ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –≤ –ë–î –¥–ª—è –∑–∞–¥–∞–Ω–Ω–æ–≥–æ –ø–µ—Ä–∏–æ–¥–∞

**–†–µ—à–µ–Ω–∏–µ:**
1. –ó–∞–≥—Ä—É–∑–∏—Ç—å —Ü–µ–Ω—ã: `POST /prices/fetch`
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å: `GET /prices/available`

### –û—à–∏–±–∫–∞: "No model found"

**–ü—Ä–∏—á–∏–Ω–∞:** –ù–µ—Ç –æ–±—É—á–µ–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏ –≤ `artifacts/models/`

**–†–µ—à–µ–Ω–∏–µ:**
1. –û–±—É—á–∏—Ç—å –º–æ–¥–µ–ª—å: `POST /model/train`
2. –ò–ª–∏ —É–∫–∞–∑–∞—Ç—å model_path —è–≤–Ω–æ

### –û—à–∏–±–∫–∞: "Insufficient data (< 10 rows)"

**–ü—Ä–∏—á–∏–Ω–∞:** –°–ª–∏—à–∫–æ–º –∫–æ—Ä–æ—Ç–∫–∏–π –ø–µ—Ä–∏–æ–¥ –∏–ª–∏ –Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö –ø–æ—Å–ª–µ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –ø–æ –¥–∞—Ç–∞–º

**–†–µ—à–µ–Ω–∏–µ:**
1. –†–∞—Å—à–∏—Ä–∏—Ç—å –¥–∏–∞–ø–∞–∑–æ–Ω –¥–∞—Ç
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å start_date/end_date
3. –ó–∞–≥—Ä—É–∑–∏—Ç—å –±–æ–ª—å—à–µ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö

### –ù–∏–∑–∫–∏–µ –º–µ—Ç—Ä–∏–∫–∏ (Sharpe < 0.5)

**–ü—Ä–∏—á–∏–Ω—ã:**
- –ú–æ–¥–µ–ª—å –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∞ (overfitting)
- –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –æ–±—É—á–µ–Ω–∏—è
- –í—ã—Å–æ–∫–∏–µ –∫–æ–º–∏—Å—Å–∏–∏/–ø—Ä–æ—Å–∫–∞–ª—å–∑—ã–≤–∞–Ω–∏–µ

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü–µ—Ä–µ–æ–±—É—á–∏—Ç—å –º–æ–¥–µ–ª—å –Ω–∞ –±–æ–ª—å—à–µ–º –¥–∞—Ç–∞—Å–µ—Ç–µ
2. –£–º–µ–Ω—å—à–∏—Ç—å signal_threshold –¥–ª—è –±–æ–ª—å—à–µ–π —Å–µ–ª–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–∞—á–µ—Å—Ç–≤–æ –º–æ–¥–µ–ª–∏: `GET /model/current`

---

## –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:

1. **–°—Ä–∞–≤–Ω–∏—Ç—å —Å paper trading:**
   - –ó–∞–ø—É—Å—Ç–∏—Ç—å –±—ç–∫—Ç–µ—Å—Ç –Ω–∞ —Ç–µ—Ö –∂–µ –¥–∞—Ç–∞—Ö
   - –°—Ä–∞–≤–Ω–∏—Ç—å –º–µ—Ç—Ä–∏–∫–∏ —Å —Ä–µ–∞–ª—å–Ω—ã–º paper trading

2. **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤:**
   - –ü–æ–¥–æ–±—Ä–∞—Ç—å –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–π signal_threshold
   - –ü–æ–¥–æ–±—Ä–∞—Ç—å –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–π position_size
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–∑–Ω—ã–µ latency_bars

3. **–ü–µ—Ä–µ–π—Ç–∏ –∫ –ó–∞–¥–∞—á–µ #2: RL-–∞–≥–µ–Ω—Ç:**
   - Stable-Baselines3 PPO
   - –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π sizing
   - Hybrid –º–æ–¥–µ–ª—å (XGBoost + RL)

---

**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:** 2025-10-10  
**–í–µ—Ä—Å–∏—è:** 1.0  
**–°—Ç–∞—Ç—É—Å:** –ì–æ—Ç–æ–≤ –∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é

