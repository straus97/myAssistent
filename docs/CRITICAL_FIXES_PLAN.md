# üö® –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –ü–†–û–ë–õ–ï–ú–´ MyAssistent - –ü–õ–ê–ù –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø

## üìã –¢–ï–ö–£–©–ï–ï –°–û–°–¢–û–Ø–ù–ò–ï (21 –æ–∫—Ç—è–±—Ä—è 2025)

### ‚ùå –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã:
1. **UniqueViolation –æ—à–∏–±–∫–∏** - —Å–∏—Å—Ç–µ–º–∞ –Ω–µ –º–æ–∂–µ—Ç –æ–±–Ω–æ–≤–ª—è—Ç—å –¥–∞–Ω–Ω—ã–µ
2. **–°—Ç–∞—Ä–∞—è –ø–æ–∑–∏—Ü–∏—è** - BTC/USDT –æ—Ç–∫—Ä—ã—Ç–∞ 14 –æ–∫—Ç—è–±—Ä—è (7 –¥–Ω–µ–π)
3. **–ù–µ—Ç –Ω–æ–≤—ã—Ö —Å–∏–≥–Ω–∞–ª–æ–≤** - –ø–æ—Å–ª–µ–¥–Ω–∏–µ –æ—Ç 17 –æ–∫—Ç—è–±—Ä—è
4. **–ü—É—Å—Ç—ã–µ –¥–∞–Ω–Ω—ã–µ —Ü–µ–Ω** - `prices/latest` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `[]`
5. **–°–ø–∞–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è** - –ø–æ—Å—Ç–æ—è–Ω–Ω—ã–µ "POSITION TOO OLD"

### üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø—Ä–æ–±–ª–µ–º:
- **–û—à–∏–±–∫–∏ –ë–î**: –ü–æ—Å—Ç–æ—è–Ω–Ω—ã–µ `duplicate key value violates unique constraint "uq_price_row"`
- **–í–æ–∑—Ä–∞—Å—Ç –ø–æ–∑–∏—Ü–∏–∏**: 129+ —á–∞—Å–æ–≤ (–ª–∏–º–∏—Ç 72 —á–∞—Å–∞)
- **–ü–æ—Å–ª–µ–¥–Ω–∏–π —Å–∏–≥–Ω–∞–ª**: 4 –¥–Ω—è –Ω–∞–∑–∞–¥
- **–°—Ç–∞—Ç—É—Å –º–æ–Ω–∏—Ç–æ—Ä–∞**: `last_update: 2025-10-21T20:25:00` –Ω–æ —Å–∏–≥–Ω–∞–ª—ã —Å—Ç–∞—Ä—ã–µ

## üõ†Ô∏è –ü–õ–ê–ù –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø

### –≠—Ç–∞–ø 1: –≠–∫—Å—Ç—Ä–µ–Ω–Ω–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ (–°–ï–ô–ß–ê–°)

#### 1.1 –û—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–∏—Å—Ç–µ–º—ã
```bash
sudo systemctl stop myassistent
```

#### 1.2 –û—á–∏—Å—Ç–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
```sql
-- –£–¥–∞–ª–µ–Ω–∏–µ –¥—É–±–ª–∏—Ä—É—é—â–∏—Ö—Å—è –∑–∞–ø–∏—Å–µ–π —Ü–µ–Ω
DELETE FROM prices 
WHERE id NOT IN (
    SELECT MAX(id) 
    FROM prices 
    GROUP BY exchange, symbol, timeframe, ts
);

-- –£–¥–∞–ª–µ–Ω–∏–µ —Å—Ç–∞—Ä—ã—Ö —Å–∏–≥–Ω–∞–ª–æ–≤ (—Å—Ç–∞—Ä—à–µ 3 –¥–Ω–µ–π)
DELETE FROM signals 
WHERE created_at < datetime('now', '-3 days');

-- –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –∑–∞–∫—Ä—ã—Ç–∏–µ —Å—Ç–∞—Ä–æ–π –ø–æ–∑–∏—Ü–∏–∏
UPDATE positions 
SET status = 'closed', closed_at = datetime('now'), close_reason = 'force_close_old'
WHERE symbol = 'BTC/USDT' AND opened_at < datetime('now', '-3 days');
```

#### 1.3 –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ —Å–∏—Å—Ç–µ–º—ã
```bash
sudo systemctl start myassistent
sleep 10
```

### –≠—Ç–∞–ø 2: –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö

#### 2.1 –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ü–µ–Ω
```bash
curl -X POST "http://localhost:8000/prices/fetch" \
  -H "X-API-Key: 5fa613c18a92d0d69d3bf5a5f7d72396cd5cca41ed0bc1d058db499107ba6f73" \
  -H "Content-Type: application/json" \
  -d '{
    "symbols": ["BTC/USDT"], 
    "timeframe": "1h", 
    "force_update": true, 
    "clear_duplicates": true
  }'
```

#### 2.2 –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –º–æ–Ω–∏—Ç–æ—Ä–∞
```bash
curl -X POST "http://localhost:8000/paper-monitor/update" \
  -H "X-API-Key: 5fa613c18a92d0d69d3bf5a5f7d72396cd5cca41ed0bc1d058db499107ba6f73" \
  -H "Content-Type: application/json" \
  -d '{"force_update": true}'
```

### –≠—Ç–∞–ø 3: –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—è

#### 3.1 –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è
```bash
curl -H "X-API-Key: 5fa613c18a92d0d69d3bf5a5f7d72396cd5cca41ed0bc1d058db499107ba6f73" \
  http://localhost:8000/health | python3 -m json.tool
```

#### 3.2 –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö
```bash
curl -H "X-API-Key: 5fa613c18a92d0d69d3bf5a5f7d72396cd5cca41ed0bc1d058db499107ba6f73" \
  "http://localhost:8000/prices/latest?symbol=BTC/USDT&timeframe=1h&limit=3" | python3 -m json.tool
```

#### 3.3 –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–æ–≤—ã—Ö —Å–∏–≥–Ω–∞–ª–æ–≤
```bash
curl -H "X-API-Key: 5fa613c18a92d0d69d3bf5a5f7d72396cd5cca41ed0bc1d058db499107ba6f73" \
  "http://localhost:8000/signals/recent?limit=3" | python3 -m json.tool
```

## üìÖ –ü–õ–ê–ù –ï–ñ–ï–î–ù–ï–í–ù–û–ì–û –ú–û–ù–ò–¢–û–†–ò–ù–ì–ê

### –£—Ç—Ä–µ–Ω–Ω—è—è –ø—Ä–æ–≤–µ—Ä–∫–∞ (09:00)
```bash
cd ~/myAssistent
./daily_monitoring.sh
```

**–ö—Ä–∏—Ç–µ—Ä–∏–∏ —É—Å–ø–µ—Ö–∞:**
- ‚úÖ –°–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç (`health: ok`)
- ‚úÖ –ú–æ–Ω–∏—Ç–æ—Ä –≤–∫–ª—é—á–µ–Ω (`enabled: true`)
- ‚úÖ –ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ < 30 –º–∏–Ω—É—Ç
- ‚úÖ –ù–µ—Ç –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–æ–∫ –≤ –ª–æ–≥–∞—Ö
- ‚úÖ –ï—Å—Ç—å —Å–≤–µ–∂–∏–µ –¥–∞–Ω–Ω—ã–µ —Ü–µ–Ω

### –í–µ—á–µ—Ä–Ω—è—è –ø—Ä–æ–≤–µ—Ä–∫–∞ (21:00)
```bash
cd ~/myAssistent
./daily_monitoring.sh
```

**–ö—Ä–∏—Ç–µ—Ä–∏–∏ —É—Å–ø–µ—Ö–∞:**
- ‚úÖ –°–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ
- ‚úÖ –ù–æ–≤—ã–µ —Å–∏–≥–Ω–∞–ª—ã –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è
- ‚úÖ –ü–æ–∑–∏—Ü–∏–∏ –Ω–µ —Å—Ç–∞—Ä—à–µ 48 —á–∞—Å–æ–≤
- ‚úÖ Equity —Å—Ç–∞–±–∏–ª—å–Ω–∞—è –∏–ª–∏ —Ä–∞—Å—Ç–µ—Ç

### –ï–∂–µ–Ω–µ–¥–µ–ª—å–Ω—ã–π –æ—Ç—á–µ—Ç (–≤–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ)
```bash
# –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç—á–µ—Ç–∞
curl -X POST "http://localhost:8000/report/daily" \
  -H "X-API-Key: 5fa613c18a92d0d69d3bf5a5f7d72396cd5cca41ed0bc1d058db499107ba6f73"

# –ü—Ä–æ—Å–º–æ—Ç—Ä –æ—Ç—á–µ—Ç–∞
cat artifacts/reports/latest.html
```

## üö® –ö–†–ò–¢–ï–†–ò–ò –≠–°–ö–ê–õ–ê–¶–ò–ò

### –ù–µ–º–µ–¥–ª–µ–Ω–Ω–æ–µ –≤–º–µ—à–∞—Ç–µ–ª—å—Å—Ç–≤–æ —Ç—Ä–µ–±—É–µ—Ç—Å—è –µ—Å–ª–∏:
- ‚ùå –°–∏—Å—Ç–µ–º–∞ –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç –±–æ–ª–µ–µ 5 –º–∏–Ω—É—Ç
- ‚ùå –û—à–∏–±–∫–∏ –ë–î –ø—Ä–æ–¥–æ–ª–∂–∞—é—Ç—Å—è –±–æ–ª–µ–µ 1 —á–∞—Å–∞
- ‚ùå –ù–µ—Ç –Ω–æ–≤—ã—Ö —Å–∏–≥–Ω–∞–ª–æ–≤ –±–æ–ª–µ–µ 6 —á–∞—Å–æ–≤
- ‚ùå –ü–æ–∑–∏—Ü–∏–∏ —Å—Ç–∞—Ä—à–µ 72 —á–∞—Å–æ–≤
- ‚ùå Equity –ø–∞–¥–∞–µ—Ç –±–æ–ª–µ–µ —á–µ–º –Ω–∞ 5%

### –ö–æ–º–∞–Ω–¥—ã –¥–ª—è —ç–∫—Å—Ç—Ä–µ–Ω–Ω–æ–≥–æ –≤–º–µ—à–∞—Ç–µ–ª—å—Å—Ç–≤–∞:
```bash
# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ —Å–∏—Å—Ç–µ–º—ã
sudo systemctl restart myassistent

# –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
curl -X POST "http://localhost:8000/paper-monitor/update" \
  -H "X-API-Key: 5fa613c18a92d0d69d3bf5a5f7d72396cd5cca41ed0bc1d058db499107ba6f73" \
  -H "Content-Type: application/json" \
  -d '{"force_update": true}'

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤
journalctl -u myassistent --no-pager -n 100 | grep -i "error\|exception"
```

## üìà –¶–ï–õ–ò –ù–ê –ù–ï–î–ï–õ–Æ

### –î–µ–Ω—å 1-2: –°—Ç–∞–±–∏–ª–∏–∑–∞—Ü–∏—è
- ‚úÖ –ò—Å–ø—Ä–∞–≤–∏—Ç—å –≤—Å–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏
- ‚úÖ –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –Ω–æ—Ä–º–∞–ª—å–Ω—É—é —Ä–∞–±–æ—Ç—É –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
- ‚úÖ –û—á–∏—Å—Ç–∏—Ç—å —Å—Ç–∞—Ä—ã–µ –¥–∞–Ω–Ω—ã–µ –∏ –ø–æ–∑–∏—Ü–∏–∏

### –î–µ–Ω—å 3-5: –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
- ‚úÖ –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ —É—Ç—Ä–æ–º –∏ –≤–µ—á–µ—Ä–æ–º
- ‚úÖ –°–±–æ—Ä —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ —Ä–∞–±–æ—Ç—ã —Å–∏—Å—Ç–µ–º—ã
- ‚úÖ –ê–Ω–∞–ª–∏–∑ –∫–∞—á–µ—Å—Ç–≤–∞ —Å–∏–≥–Ω–∞–ª–æ–≤

### –î–µ–Ω—å 6-7: –ê–Ω–∞–ª–∏–∑ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏
- ‚úÖ –û—Ü–µ–Ω–∫–∞ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏ —Å–∏—Å—Ç–µ–º—ã
- ‚úÖ –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- ‚úÖ –ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–µ—Ä–µ—Ö–æ–¥–∞ –∫ —Ä–µ–∞–ª—å–Ω–æ–π —Ç–æ—Ä–≥–æ–≤–ª–µ

## üí∞ –ö–†–ò–¢–ò–ß–ù–û–°–¢–¨ –ó–ê–î–ê–ß–ò

**–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–¥—á–µ—Ä–∫–Ω—É–ª:** "–ù–∞–º –æ—à–∏–±–∞—Ç—å—Å—è –Ω–∏ –≤ –∫–æ–µ–º —Å–ª—É—á–∞–µ –Ω–µ–ª—å–∑—è. –ë—é–¥–∂–µ—Ç —É –º–µ–Ω—è –º–∞–ª–µ–Ω—å–∫–∏–π, –±–æ–ª—å—à–µ –≤–∑—è—Ç—å –Ω–µ–æ—Ç–∫—É–¥–∞, –µ—Å–ª–∏ –º—ã –ø–µ—Ä–≤—ã–µ —Ç–æ—Ä–≥–∏ –ø—Ä–æ–≤–∞–ª–∏–º, —Ç–æ –Ω–∞—à—É –∏–¥–µ—é –ø—Ä–∏–¥–µ—Ç—Å—è –æ—Ç–ª–æ–∂–∏—Ç—å –¥–æ —Å–ª–µ–¥—É—é—â–µ–≥–æ —Ä–∞–∑–∞."

**–≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç:**
- üö® **–ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô –ü–†–ò–û–†–ò–¢–ï–¢** - –∏—Å–ø—Ä–∞–≤–∏—Ç—å –≤—Å–µ –ø—Ä–æ–±–ª–µ–º—ã –°–ï–ô–ß–ê–°
- üí∞ **–§–∏–Ω–∞–Ω—Å–æ–≤—ã–µ —Ä–∏—Å–∫–∏** - –Ω–µ–ª—å–∑—è –ø–æ—Ç–µ—Ä—è—Ç—å –¥–∞–∂–µ –Ω–µ–±–æ–ª—å—à–∏–µ —Å—É–º–º—ã
- ‚è∞ **–í—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è** - –ù–æ–≤—ã–π –≥–æ–¥ —Å–∫–æ—Ä–æ, –Ω—É–∂–Ω—ã –¥–µ–Ω—å–≥–∏
- üéØ **–û–¥–∏–Ω —à–∞–Ω—Å** - –µ—Å–ª–∏ –ø—Ä–æ–≤–∞–ª–∏–º –ø–µ—Ä–≤—ã–µ —Ç–æ—Ä–≥–∏, –ø—Ä–æ–µ–∫—Ç –æ—Ç–∫–ª–∞–¥—ã–≤–∞–µ—Ç—Å—è

## ‚úÖ –ö–†–ò–¢–ï–†–ò–ò –ì–û–¢–û–í–ù–û–°–¢–ò –ö –†–ï–ê–õ–¨–ù–û–ô –¢–û–†–ì–û–í–õ–ï

1. **–°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å —Å–∏—Å—Ç–µ–º—ã**: 7 –¥–Ω–µ–π –±–µ–∑ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–æ–∫
2. **–ö–∞—á–µ—Å—Ç–≤–æ —Å–∏–≥–Ω–∞–ª–æ–≤**: >70% —Ç–æ—á–Ω–æ—Å—Ç—å –Ω–∞ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö —Å–∏–≥–Ω–∞–ª–∞—Ö
3. **–†–∏—Å–∫-–º–µ–Ω–µ–¥–∂–º–µ–Ω—Ç**: –í—Å–µ –∑–∞—â–∏—Ç–Ω—ã–µ –º–µ—Ö–∞–Ω–∏–∑–º—ã —Ä–∞–±–æ—Ç–∞—é—Ç
4. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫–∞–∂–¥—ã–µ 15 –º–∏–Ω—É—Ç
5. **–†–µ–∑–µ—Ä–≤–Ω—ã–µ –ø–ª–∞–Ω—ã**: –ü—Ä–æ—Ü–µ–¥—É—Ä—ã –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –ø—Ä–∏ —Å–±–æ—è—Ö

---

**–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥:** –í—ã–ø–æ–ª–Ω–∏—Ç—å —Å–∫—Ä–∏–ø—Ç `fix_critical_issues.sh` –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ –¥–ª—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤—Å–µ—Ö –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –ø—Ä–æ–±–ª–µ–º.
