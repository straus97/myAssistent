================================================================================
ENSEMBLE MODEL TRAINING WITH HYPERPARAMETER OPTIMIZATION

================================================================================
Exchange: bybit
Symbol: BTC/USDT
Timeframe: 1h
Optuna trials per model: 30

[1/6] Loading dataset...
[Features] Dataset built: 2129 rows x 84 features
[Features] Base: 6 price, Lag: 12, Time: 11, Technical: 37, News: 24
[Features] PHASE 2: Static features (OnChain/Macro/Social: 28) DISABLED
[Features] Total dynamic features: 84 (was 112, removed 28 static)
Dataset: 2129 rows x 84 features
Date range: 2025-07-15 13:00:00+00:00 -> 2025-10-12 05:00:00+00:00

[2/6] Splitting data (60% train, 20% val, 20% test)...
Train: 1277 samples
Validation: 426 samples
Test: 426 samples

[3/6] Hyperparameter optimization with Optuna...

[Optuna] Optimizing XGBoost (30 trials)...
  0%|          | 0/30 [00:00<?, ?it/s]
Best trial: 0. Best value: 0.540887:   0%|          | 0/30 [00:00<?, ?it/s]
Best trial: 0. Best value: 0.540887:   3%|3         | 1/30 [00:00<00:19,  1.46it/s]
Best trial: 0. Best value: 0.540887:   3%|3         | 1/30 [00:00<00:19,  1.46it/s, 0.68/3600 seconds]
Best trial: 1. Best value: 0.595029:   3%|3         | 1/30 [00:01<00:19,  1.46it/s, 0.68/3600 seconds]
Best trial: 1. Best value: 0.595029:   7%|6         | 2/30 [00:01<00:13,  2.12it/s, 0.68/3600 seconds]
Best trial: 1. Best value: 0.595029:   7%|6         | 2/30 [00:01<00:13,  2.12it/s, 1.01/3600 seconds]
Best trial: 1. Best value: 0.595029:   7%|6         | 2/30 [00:01<00:13,  2.12it/s, 1.01/3600 seconds]
Best trial: 1. Best value: 0.595029:  10%|#         | 3/30 [00:01<00:11,  2.37it/s, 1.01/3600 seconds]
Best trial: 1. Best value: 0.595029:  10%|#         | 3/30 [00:01<00:11,  2.37it/s, 1.37/3600 seconds]
Best trial: 1. Best value: 0.595029:  10%|#         | 3/30 [00:02<00:11,  2.37it/s, 1.37/3600 seconds]
Best trial: 1. Best value: 0.595029:  13%|#3        | 4/30 [00:02<00:15,  1.68it/s, 1.37/3600 seconds]
Best trial: 1. Best value: 0.595029:  13%|#3        | 4/30 [00:02<00:15,  1.68it/s, 2.23/3600 seconds]
Best trial: 4. Best value: 0.603101:  13%|#3        | 4/30 [00:02<00:15,  1.68it/s, 2.23/3600 seconds]
Best trial: 4. Best value: 0.603101:  17%|#6        | 5/30 [00:02<00:11,  2.22it/s, 2.23/3600 seconds]
Best trial: 4. Best value: 0.603101:  17%|#6        | 5/30 [00:02<00:11,  2.22it/s, 2.42/3600 seconds]
Best trial: 4. Best value: 0.603101:  17%|#6        | 5/30 [00:02<00:11,  2.22it/s, 2.42/3600 seconds]
Best trial: 4. Best value: 0.603101:  20%|##        | 6/30 [00:02<00:10,  2.23it/s, 2.42/3600 seconds]
Best trial: 4. Best value: 0.603101:  20%|##        | 6/30 [00:02<00:10,  2.23it/s, 2.87/3600 seconds]
Best trial: 4. Best value: 0.603101:  20%|##        | 6/30 [00:03<00:10,  2.23it/s, 2.87/3600 seconds]
Best trial: 4. Best value: 0.603101:  23%|##3       | 7/30 [00:03<00:13,  1.73it/s, 2.87/3600 seconds]
Best trial: 4. Best value: 0.603101:  23%|##3       | 7/30 [00:03<00:13,  1.73it/s, 3.71/3600 seconds]
Best trial: 4. Best value: 0.603101:  23%|##3       | 7/30 [00:04<00:13,  1.73it/s, 3.71/3600 seconds]
Best trial: 4. Best value: 0.603101:  27%|##6       | 8/30 [00:04<00:11,  1.98it/s, 3.71/3600 seconds]
Best trial: 4. Best value: 0.603101:  27%|##6       | 8/30 [00:04<00:11,  1.98it/s, 4.06/3600 seconds]
Best trial: 4. Best value: 0.603101:  27%|##6       | 8/30 [00:04<00:11,  1.98it/s, 4.06/3600 seconds]
Best trial: 4. Best value: 0.603101:  30%|###       | 9/30 [00:04<00:09,  2.15it/s, 4.06/3600 seconds]
Best trial: 4. Best value: 0.603101:  30%|###       | 9/30 [00:04<00:09,  2.15it/s, 4.44/3600 seconds]
Best trial: 9. Best value: 0.624647:  30%|###       | 9/30 [00:05<00:09,  2.15it/s, 4.44/3600 seconds]
Best trial: 9. Best value: 0.624647:  33%|###3      | 10/30 [00:05<00:09,  2.01it/s, 4.44/3600 seconds]
Best trial: 9. Best value: 0.624647:  33%|###3      | 10/30 [00:05<00:09,  2.01it/s, 5.01/3600 seconds]
Best trial: 9. Best value: 0.624647:  33%|###3      | 10/30 [00:06<00:09,  2.01it/s, 5.01/3600 seconds]
Best trial: 9. Best value: 0.624647:  37%|###6      | 11/30 [00:06<00:13,  1.44it/s, 5.01/3600 seconds]
Best trial: 9. Best value: 0.624647:  37%|###6      | 11/30 [00:06<00:13,  1.44it/s, 6.15/3600 seconds]
Best trial: 9. Best value: 0.624647:  37%|###6      | 11/30 [00:07<00:13,  1.44it/s, 6.15/3600 seconds]
Best trial: 9. Best value: 0.624647:  40%|####      | 12/30 [00:07<00:13,  1.32it/s, 6.15/3600 seconds]
Best trial: 9. Best value: 0.624647:  40%|####      | 12/30 [00:07<00:13,  1.32it/s, 7.06/3600 seconds]
Best trial: 9. Best value: 0.624647:  40%|####      | 12/30 [00:07<00:13,  1.32it/s, 7.06/3600 seconds]
Best trial: 9. Best value: 0.624647:  43%|####3     | 13/30 [00:07<00:13,  1.25it/s, 7.06/3600 seconds]
Best trial: 9. Best value: 0.624647:  43%|####3     | 13/30 [00:07<00:13,  1.25it/s, 7.96/3600 seconds]
Best trial: 9. Best value: 0.624647:  43%|####3     | 13/30 [00:08<00:13,  1.25it/s, 7.96/3600 seconds]
Best trial: 9. Best value: 0.624647:  47%|####6     | 14/30 [00:08<00:12,  1.27it/s, 7.96/3600 seconds]
Best trial: 9. Best value: 0.624647:  47%|####6     | 14/30 [00:08<00:12,  1.27it/s, 8.71/3600 seconds]
Best trial: 9. Best value: 0.624647:  47%|####6     | 14/30 [00:09<00:12,  1.27it/s, 8.71/3600 seconds]
Best trial: 9. Best value: 0.624647:  50%|#####     | 15/30 [00:09<00:11,  1.29it/s, 8.71/3600 seconds]
Best trial: 9. Best value: 0.624647:  50%|#####     | 15/30 [00:09<00:11,  1.29it/s, 9.45/3600 seconds]
Best trial: 9. Best value: 0.624647:  50%|#####     | 15/30 [00:09<00:11,  1.29it/s, 9.45/3600 seconds]
Best trial: 9. Best value: 0.624647:  53%|#####3    | 16/30 [00:09<00:08,  1.68it/s, 9.45/3600 seconds]
Best trial: 9. Best value: 0.624647:  53%|#####3    | 16/30 [00:09<00:08,  1.68it/s, 9.64/3600 seconds]
Best trial: 16. Best value: 0.63413:  53%|#####3    | 16/30 [00:09<00:08,  1.68it/s, 9.64/3600 seconds]
Best trial: 16. Best value: 0.63413:  57%|#####6    | 17/30 [00:09<00:06,  2.09it/s, 9.64/3600 seconds]
Best trial: 16. Best value: 0.63413:  57%|#####6    | 17/30 [00:09<00:06,  2.09it/s, 9.84/3600 seconds]
Best trial: 16. Best value: 0.63413:  57%|#####6    | 17/30 [00:10<00:06,  2.09it/s, 9.84/3600 seconds]
Best trial: 16. Best value: 0.63413:  60%|######    | 18/30 [00:10<00:04,  2.48it/s, 9.84/3600 seconds]
Best trial: 16. Best value: 0.63413:  60%|######    | 18/30 [00:10<00:04,  2.48it/s, 10.07/3600 seconds]
Best trial: 16. Best value: 0.63413:  60%|######    | 18/30 [00:10<00:04,  2.48it/s, 10.07/3600 seconds]
Best trial: 16. Best value: 0.63413:  63%|######3   | 19/30 [00:10<00:04,  2.66it/s, 10.07/3600 seconds]
Best trial: 16. Best value: 0.63413:  63%|######3   | 19/30 [00:10<00:04,  2.66it/s, 10.38/3600 seconds]
Best trial: 19. Best value: 0.653758:  63%|######3   | 19/30 [00:10<00:04,  2.66it/s, 10.38/3600 seconds]
Best trial: 19. Best value: 0.653758:  67%|######6   | 20/30 [00:10<00:03,  3.14it/s, 10.38/3600 seconds]
Best trial: 19. Best value: 0.653758:  67%|######6   | 20/30 [00:10<00:03,  3.14it/s, 10.57/3600 seconds]
Best trial: 19. Best value: 0.653758:  67%|######6   | 20/30 [00:10<00:03,  3.14it/s, 10.57/3600 seconds]
Best trial: 19. Best value: 0.653758:  70%|#######   | 21/30 [00:10<00:02,  3.46it/s, 10.57/3600 seconds]
Best trial: 19. Best value: 0.653758:  70%|#######   | 21/30 [00:10<00:02,  3.46it/s, 10.79/3600 seconds]
Best trial: 19. Best value: 0.653758:  70%|#######   | 21/30 [00:10<00:02,  3.46it/s, 10.79/3600 seconds]
Best trial: 19. Best value: 0.653758:  73%|#######3  | 22/30 [00:10<00:02,  3.81it/s, 10.79/3600 seconds]
Best trial: 19. Best value: 0.653758:  73%|#######3  | 22/30 [00:10<00:02,  3.81it/s, 10.99/3600 seconds]
Best trial: 19. Best value: 0.653758:  73%|#######3  | 22/30 [00:11<00:02,  3.81it/s, 10.99/3600 seconds]
Best trial: 19. Best value: 0.653758:  77%|#######6  | 23/30 [00:11<00:01,  4.45it/s, 10.99/3600 seconds]
Best trial: 19. Best value: 0.653758:  77%|#######6  | 23/30 [00:11<00:01,  4.45it/s, 11.13/3600 seconds]
Best trial: 19. Best value: 0.653758:  77%|#######6  | 23/30 [00:11<00:01,  4.45it/s, 11.13/3600 seconds]
Best trial: 19. Best value: 0.653758:  80%|########  | 24/30 [00:11<00:01,  5.08it/s, 11.13/3600 seconds]
Best trial: 19. Best value: 0.653758:  80%|########  | 24/30 [00:11<00:01,  5.08it/s, 11.26/3600 seconds]
Best trial: 19. Best value: 0.653758:  80%|########  | 24/30 [00:11<00:01,  5.08it/s, 11.26/3600 seconds]
Best trial: 19. Best value: 0.653758:  83%|########3 | 25/30 [00:11<00:00,  5.71it/s, 11.26/3600 seconds]
Best trial: 19. Best value: 0.653758:  83%|########3 | 25/30 [00:11<00:00,  5.71it/s, 11.38/3600 seconds]
Best trial: 19. Best value: 0.653758:  83%|########3 | 25/30 [00:11<00:00,  5.71it/s, 11.38/3600 seconds]
Best trial: 19. Best value: 0.653758:  87%|########6 | 26/30 [00:11<00:00,  5.69it/s, 11.38/3600 seconds]
Best trial: 19. Best value: 0.653758:  87%|########6 | 26/30 [00:11<00:00,  5.69it/s, 11.56/3600 seconds]
Best trial: 19. Best value: 0.653758:  87%|########6 | 26/30 [00:11<00:00,  5.69it/s, 11.56/3600 seconds]
Best trial: 19. Best value: 0.653758:  90%|######### | 27/30 [00:11<00:00,  5.37it/s, 11.56/3600 seconds]
Best trial: 19. Best value: 0.653758:  90%|######### | 27/30 [00:11<00:00,  5.37it/s, 11.77/3600 seconds]
Best trial: 19. Best value: 0.653758:  90%|######### | 27/30 [00:12<00:00,  5.37it/s, 11.77/3600 seconds]
Best trial: 19. Best value: 0.653758:  93%|#########3| 28/30 [00:12<00:00,  4.56it/s, 11.77/3600 seconds]
Best trial: 19. Best value: 0.653758:  93%|#########3| 28/30 [00:12<00:00,  4.56it/s, 12.07/3600 seconds]
Best trial: 19. Best value: 0.653758:  93%|#########3| 28/30 [00:12<00:00,  4.56it/s, 12.07/3600 seconds]
Best trial: 19. Best value: 0.653758:  97%|#########6| 29/30 [00:12<00:00,  4.65it/s, 12.07/3600 seconds]
Best trial: 19. Best value: 0.653758:  97%|#########6| 29/30 [00:12<00:00,  4.65it/s, 12.27/3600 seconds]
Best trial: 19. Best value: 0.653758:  97%|#########6| 29/30 [00:12<00:00,  4.65it/s, 12.27/3600 seconds]
Best trial: 19. Best value: 0.653758: 100%|##########| 30/30 [00:12<00:00,  3.56it/s, 12.27/3600 seconds]
Best trial: 19. Best value: 0.653758: 100%|##########| 30/30 [00:12<00:00,  3.56it/s, 12.70/3600 seconds]
Best trial: 19. Best value: 0.653758: 100%|##########| 30/30 [00:12<00:00,  2.36it/s, 12.70/3600 seconds]
[Optuna] XGBoost best AUC: 0.6538
[Optuna] XGBoost best params: {'n_estimators': 193, 'max_depth': 3, 'learning_rate': 0.01060187444229244, 'subsample': 0.8789389294686962, 'colsample_bytree': 0.7211422591005, 'min_child_weight': 9, 'gamma': 0.2938998840058604, 'reg_alpha': 0.1695815293877519, 'reg_lambda': 0.7001940805208506}

[Optuna] Optimizing LightGBM (30 trials)...

  0%|          | 0/30 [00:00<?, ?it/s]
Best trial: 0. Best value: 0.557163:   0%|          | 0/30 [00:00<?, ?it/s]
Best trial: 0. Best value: 0.557163:   3%|3         | 1/30 [00:00<00:10,  2.86it/s]
Best trial: 0. Best value: 0.557163:   3%|3         | 1/30 [00:00<00:10,  2.86it/s, 0.35/3600 seconds]
Best trial: 0. Best value: 0.557163:   3%|3         | 1/30 [00:00<00:10,  2.86it/s, 0.35/3600 seconds]
Best trial: 0. Best value: 0.557163:   7%|6         | 2/30 [00:00<00:07,  3.71it/s, 0.35/3600 seconds]
Best trial: 0. Best value: 0.557163:   7%|6         | 2/30 [00:00<00:07,  3.71it/s, 0.56/3600 seconds]
Best trial: 2. Best value: 0.580011:   7%|6         | 2/30 [00:00<00:07,  3.71it/s, 0.56/3600 seconds]
Best trial: 2. Best value: 0.580011:  10%|#         | 3/30 [00:00<00:06,  4.46it/s, 0.56/3600 seconds]
Best trial: 2. Best value: 0.580011:  10%|#         | 3/30 [00:00<00:06,  4.46it/s, 0.73/3600 seconds]
Best trial: 2. Best value: 0.580011:  10%|#         | 3/30 [00:01<00:06,  4.46it/s, 0.73/3600 seconds]
Best trial: 2. Best value: 0.580011:  13%|#3        | 4/30 [00:01<00:07,  3.27it/s, 0.73/3600 seconds]
Best trial: 2. Best value: 0.580011:  13%|#3        | 4/30 [00:01<00:07,  3.27it/s, 1.16/3600 seconds]
Best trial: 4. Best value: 0.585899:  13%|#3        | 4/30 [00:01<00:07,  3.27it/s, 1.16/3600 seconds]
Best trial: 4. Best value: 0.585899:  17%|#6        | 5/30 [00:01<00:07,  3.27it/s, 1.24/3600 seconds]
Best trial: 5. Best value: 0.598028:  17%|#6        | 5/30 [00:01<00:07,  3.27it/s, 1.24/3600 seconds]
Best trial: 5. Best value: 0.598028:  20%|##        | 6/30 [00:01<00:04,  4.87it/s, 1.24/3600 seconds]
Best trial: 5. Best value: 0.598028:  20%|##        | 6/30 [00:01<00:04,  4.87it/s, 1.40/3600 seconds]
Best trial: 5. Best value: 0.598028:  20%|##        | 6/30 [00:01<00:04,  4.87it/s, 1.40/3600 seconds]
Best trial: 5. Best value: 0.598028:  23%|##3       | 7/30 [00:01<00:06,  3.57it/s, 1.40/3600 seconds]
Best trial: 5. Best value: 0.598028:  23%|##3       | 7/30 [00:01<00:06,  3.57it/s, 1.87/3600 seconds]
Best trial: 5. Best value: 0.598028:  23%|##3       | 7/30 [00:02<00:06,  3.57it/s, 1.87/3600 seconds]
Best trial: 5. Best value: 0.598028:  27%|##6       | 8/30 [00:02<00:06,  3.50it/s, 1.87/3600 seconds]
Best trial: 5. Best value: 0.598028:  27%|##6       | 8/30 [00:02<00:06,  3.50it/s, 2.17/3600 seconds]
Best trial: 5. Best value: 0.598028:  27%|##6       | 8/30 [00:02<00:06,  3.50it/s, 2.17/3600 seconds]
Best trial: 5. Best value: 0.598028:  30%|###       | 9/30 [00:02<00:05,  3.68it/s, 2.17/3600 seconds]
Best trial: 5. Best value: 0.598028:  30%|###       | 9/30 [00:02<00:05,  3.68it/s, 2.41/3600 seconds]
Best trial: 9. Best value: 0.627889:  30%|###       | 9/30 [00:02<00:05,  3.68it/s, 2.41/3600 seconds]
Best trial: 9. Best value: 0.627889:  33%|###3      | 10/30 [00:02<00:04,  4.10it/s, 2.41/3600 seconds]
Best trial: 9. Best value: 0.627889:  33%|###3      | 10/30 [00:02<00:04,  4.10it/s, 2.59/3600 seconds]
Best trial: 9. Best value: 0.627889:  33%|###3      | 10/30 [00:02<00:04,  4.10it/s, 2.59/3600 seconds]
Best trial: 9. Best value: 0.627889:  37%|###6      | 11/30 [00:02<00:05,  3.62it/s, 2.59/3600 seconds]
Best trial: 9. Best value: 0.627889:  37%|###6      | 11/30 [00:02<00:05,  3.62it/s, 2.94/3600 seconds]
Best trial: 9. Best value: 0.627889:  37%|###6      | 11/30 [00:03<00:05,  3.62it/s, 2.94/3600 seconds]
Best trial: 9. Best value: 0.627889:  40%|####      | 12/30 [00:03<00:05,  3.51it/s, 2.94/3600 seconds]
Best trial: 9. Best value: 0.627889:  40%|####      | 12/30 [00:03<00:05,  3.51it/s, 3.25/3600 seconds]
Best trial: 9. Best value: 0.627889:  40%|####      | 12/30 [00:03<00:05,  3.51it/s, 3.25/3600 seconds]
Best trial: 9. Best value: 0.627889:  43%|####3     | 13/30 [00:03<00:04,  3.54it/s, 3.25/3600 seconds]
Best trial: 9. Best value: 0.627889:  43%|####3     | 13/30 [00:03<00:04,  3.54it/s, 3.52/3600 seconds]
Best trial: 9. Best value: 0.627889:  43%|####3     | 13/30 [00:03<00:04,  3.54it/s, 3.52/3600 seconds]
Best trial: 9. Best value: 0.627889:  47%|####6     | 14/30 [00:03<00:04,  3.86it/s, 3.52/3600 seconds]
Best trial: 9. Best value: 0.627889:  47%|####6     | 14/30 [00:03<00:04,  3.86it/s, 3.73/3600 seconds]
Best trial: 9. Best value: 0.627889:  47%|####6     | 14/30 [00:03<00:04,  3.86it/s, 3.73/3600 seconds]
Best trial: 9. Best value: 0.627889:  50%|#####     | 15/30 [00:03<00:03,  4.11it/s, 3.73/3600 seconds]
Best trial: 9. Best value: 0.627889:  50%|#####     | 15/30 [00:03<00:03,  4.11it/s, 3.93/3600 seconds]
Best trial: 15. Best value: 0.630315:  50%|#####     | 15/30 [00:04<00:03,  4.11it/s, 3.93/3600 seconds]
Best trial: 15. Best value: 0.630315:  53%|#####3    | 16/30 [00:04<00:03,  4.15it/s, 3.93/3600 seconds]
Best trial: 15. Best value: 0.630315:  53%|#####3    | 16/30 [00:04<00:03,  4.15it/s, 4.17/3600 seconds]
Best trial: 15. Best value: 0.630315:  53%|#####3    | 16/30 [00:04<00:03,  4.15it/s, 4.17/3600 seconds]
Best trial: 15. Best value: 0.630315:  57%|#####6    | 17/30 [00:04<00:03,  3.77it/s, 4.17/3600 seconds]
Best trial: 15. Best value: 0.630315:  57%|#####6    | 17/30 [00:04<00:03,  3.77it/s, 4.49/3600 seconds]
Best trial: 15. Best value: 0.630315:  57%|#####6    | 17/30 [00:04<00:03,  3.77it/s, 4.49/3600 seconds]
Best trial: 15. Best value: 0.630315:  60%|######    | 18/30 [00:04<00:02,  4.29it/s, 4.49/3600 seconds]
Best trial: 15. Best value: 0.630315:  60%|######    | 18/30 [00:04<00:02,  4.29it/s, 4.65/3600 seconds]
Best trial: 15. Best value: 0.630315:  60%|######    | 18/30 [00:04<00:02,  4.29it/s, 4.65/3600 seconds]
Best trial: 15. Best value: 0.630315:  63%|######3   | 19/30 [00:04<00:02,  4.23it/s, 4.65/3600 seconds]
Best trial: 15. Best value: 0.630315:  63%|######3   | 19/30 [00:04<00:02,  4.23it/s, 4.89/3600 seconds]
Best trial: 15. Best value: 0.630315:  63%|######3   | 19/30 [00:05<00:02,  4.23it/s, 4.89/3600 seconds]
Best trial: 15. Best value: 0.630315:  67%|######6   | 20/30 [00:05<00:02,  4.64it/s, 4.89/3600 seconds]
Best trial: 15. Best value: 0.630315:  67%|######6   | 20/30 [00:05<00:02,  4.64it/s, 5.06/3600 seconds]
Best trial: 15. Best value: 0.630315:  67%|######6   | 20/30 [00:05<00:02,  4.64it/s, 5.06/3600 seconds]
Best trial: 15. Best value: 0.630315:  70%|#######   | 21/30 [00:05<00:02,  3.72it/s, 5.06/3600 seconds]
Best trial: 15. Best value: 0.630315:  70%|#######   | 21/30 [00:05<00:02,  3.72it/s, 5.45/3600 seconds]
Best trial: 15. Best value: 0.630315:  70%|#######   | 21/30 [00:05<00:02,  3.72it/s, 5.45/3600 seconds]
Best trial: 15. Best value: 0.630315:  73%|#######3  | 22/30 [00:05<00:01,  4.12it/s, 5.45/3600 seconds]
Best trial: 15. Best value: 0.630315:  73%|#######3  | 22/30 [00:05<00:01,  4.12it/s, 5.64/3600 seconds]
Best trial: 15. Best value: 0.630315:  73%|#######3  | 22/30 [00:05<00:01,  4.12it/s, 5.64/3600 seconds]
Best trial: 15. Best value: 0.630315:  77%|#######6  | 23/30 [00:05<00:01,  4.19it/s, 5.64/3600 seconds]
Best trial: 15. Best value: 0.630315:  77%|#######6  | 23/30 [00:05<00:01,  4.19it/s, 5.86/3600 seconds]
Best trial: 15. Best value: 0.630315:  77%|#######6  | 23/30 [00:06<00:01,  4.19it/s, 5.86/3600 seconds]
Best trial: 15. Best value: 0.630315:  80%|########  | 24/30 [00:06<00:01,  4.77it/s, 5.86/3600 seconds]
Best trial: 15. Best value: 0.630315:  80%|########  | 24/30 [00:06<00:01,  4.77it/s, 6.01/3600 seconds]
Best trial: 15. Best value: 0.630315:  80%|########  | 24/30 [00:06<00:01,  4.77it/s, 6.01/3600 seconds]
Best trial: 15. Best value: 0.630315:  83%|########3 | 25/30 [00:06<00:01,  4.72it/s, 6.01/3600 seconds]
Best trial: 15. Best value: 0.630315:  83%|########3 | 25/30 [00:06<00:01,  4.72it/s, 6.22/3600 seconds]
Best trial: 15. Best value: 0.630315:  83%|########3 | 25/30 [00:06<00:01,  4.72it/s, 6.22/3600 seconds]
Best trial: 15. Best value: 0.630315:  87%|########6 | 26/30 [00:06<00:00,  4.20it/s, 6.22/3600 seconds]
Best trial: 15. Best value: 0.630315:  87%|########6 | 26/30 [00:06<00:00,  4.20it/s, 6.52/3600 seconds]
Best trial: 15. Best value: 0.630315:  87%|########6 | 26/30 [00:06<00:00,  4.20it/s, 6.52/3600 seconds]
Best trial: 15. Best value: 0.630315:  90%|######### | 27/30 [00:06<00:00,  4.20it/s, 6.52/3600 seconds]
Best trial: 15. Best value: 0.630315:  90%|######### | 27/30 [00:06<00:00,  4.20it/s, 6.76/3600 seconds]
Best trial: 15. Best value: 0.630315:  90%|######### | 27/30 [00:06<00:00,  4.20it/s, 6.76/3600 seconds]
Best trial: 15. Best value: 0.630315:  93%|#########3| 28/30 [00:06<00:00,  4.45it/s, 6.76/3600 seconds]
Best trial: 15. Best value: 0.630315:  93%|#########3| 28/30 [00:06<00:00,  4.45it/s, 6.95/3600 seconds]
Best trial: 15. Best value: 0.630315:  93%|#########3| 28/30 [00:07<00:00,  4.45it/s, 6.95/3600 seconds]
Best trial: 15. Best value: 0.630315:  97%|#########6| 29/30 [00:07<00:00,  4.57it/s, 6.95/3600 seconds]
Best trial: 15. Best value: 0.630315:  97%|#########6| 29/30 [00:07<00:00,  4.57it/s, 7.16/3600 seconds]
Best trial: 15. Best value: 0.630315:  97%|#########6| 29/30 [00:07<00:00,  4.57it/s, 7.16/3600 seconds]
Best trial: 15. Best value: 0.630315: 100%|##########| 30/30 [00:07<00:00,  5.04it/s, 7.16/3600 seconds]
Best trial: 15. Best value: 0.630315: 100%|##########| 30/30 [00:07<00:00,  5.04it/s, 7.31/3600 seconds]
Best trial: 15. Best value: 0.630315: 100%|##########| 30/30 [00:07<00:00,  4.10it/s, 7.31/3600 seconds]
[Optuna] LightGBM best AUC: 0.6303
[Optuna] LightGBM best params: {'n_estimators': 400, 'max_depth': 4, 'learning_rate': 0.016886238737072363, 'subsample': 0.6043956756975085, 'colsample_bytree': 0.8561711433906496, 'min_child_samples': 68, 'num_leaves': 175, 'reg_alpha': 0.407661546046331, 'reg_lambda': 0.36895813544501493}

[Optuna] Optimizing CatBoost (30 trials)...

  0%|          | 0/30 [00:00<?, ?it/s]
Best trial: 0. Best value: 0.548099:   0%|          | 0/30 [00:19<?, ?it/s]
Best trial: 0. Best value: 0.548099:   3%|3         | 1/30 [00:19<09:17, 19.22s/it]
Best trial: 0. Best value: 0.548099:   3%|3         | 1/30 [00:19<09:17, 19.22s/it, 19.22/3600 seconds]
Best trial: 0. Best value: 0.548099:   3%|3         | 1/30 [00:19<09:17, 19.22s/it, 19.22/3600 seconds]
Best trial: 0. Best value: 0.548099:   7%|6         | 2/30 [00:19<03:47,  8.11s/it, 19.22/3600 seconds]
Best trial: 0. Best value: 0.548099:   7%|6         | 2/30 [00:19<03:47,  8.11s/it, 19.55/3600 seconds]
Best trial: 2. Best value: 0.549974:   7%|6         | 2/30 [00:27<03:47,  8.11s/it, 19.55/3600 seconds]
Best trial: 2. Best value: 0.549974:  10%|#         | 3/30 [00:27<03:39,  8.12s/it, 19.55/3600 seconds]
Best trial: 2. Best value: 0.549974:  10%|#         | 3/30 [00:27<03:39,  8.12s/it, 27.68/3600 seconds]
Best trial: 3. Best value: 0.560295:  10%|#         | 3/30 [00:28<03:39,  8.12s/it, 27.68/3600 seconds]
Best trial: 3. Best value: 0.560295:  13%|#3        | 4/30 [00:28<02:12,  5.11s/it, 27.68/3600 seconds]
Best trial: 3. Best value: 0.560295:  13%|#3        | 4/30 [00:28<02:12,  5.11s/it, 28.19/3600 seconds]
Best trial: 3. Best value: 0.560295:  13%|#3        | 4/30 [00:29<02:12,  5.11s/it, 28.19/3600 seconds]
Best trial: 3. Best value: 0.560295:  17%|#6        | 5/30 [00:29<01:29,  3.59s/it, 28.19/3600 seconds]
Best trial: 3. Best value: 0.560295:  17%|#6        | 5/30 [00:29<01:29,  3.59s/it, 29.06/3600 seconds]
Best trial: 3. Best value: 0.560295:  17%|#6        | 5/30 [00:29<01:29,  3.59s/it, 29.06/3600 seconds]
Best trial: 3. Best value: 0.560295:  20%|##        | 6/30 [00:29<01:04,  2.68s/it, 29.06/3600 seconds]
Best trial: 3. Best value: 0.560295:  20%|##        | 6/30 [00:29<01:04,  2.68s/it, 29.97/3600 seconds]
Best trial: 6. Best value: 0.588479:  20%|##        | 6/30 [00:30<01:04,  2.68s/it, 29.97/3600 seconds]
Best trial: 6. Best value: 0.588479:  23%|##3       | 7/30 [00:30<00:47,  2.07s/it, 29.97/3600 seconds]
Best trial: 6. Best value: 0.588479:  23%|##3       | 7/30 [00:30<00:47,  2.07s/it, 30.78/3600 seconds]
Best trial: 7. Best value: 0.604556:  23%|##3       | 7/30 [00:32<00:47,  2.07s/it, 30.78/3600 seconds]
Best trial: 7. Best value: 0.604556:  27%|##6       | 8/30 [00:32<00:39,  1.82s/it, 30.78/3600 seconds]
Best trial: 7. Best value: 0.604556:  27%|##6       | 8/30 [00:32<00:39,  1.82s/it, 32.06/3600 seconds]
Best trial: 8. Best value: 0.606497:  27%|##6       | 8/30 [00:32<00:39,  1.82s/it, 32.06/3600 seconds]
Best trial: 8. Best value: 0.606497:  30%|###       | 9/30 [00:32<00:31,  1.48s/it, 32.06/3600 seconds]
Best trial: 8. Best value: 0.606497:  30%|###       | 9/30 [00:32<00:31,  1.48s/it, 32.80/3600 seconds]
Best trial: 8. Best value: 0.606497:  30%|###       | 9/30 [00:33<00:31,  1.48s/it, 32.80/3600 seconds]
Best trial: 8. Best value: 0.606497:  33%|###3      | 10/30 [00:33<00:27,  1.36s/it, 32.80/3600 seconds]
Best trial: 8. Best value: 0.606497:  33%|###3      | 10/30 [00:33<00:27,  1.36s/it, 33.90/3600 seconds]
Best trial: 8. Best value: 0.606497:  33%|###3      | 10/30 [00:37<00:27,  1.36s/it, 33.90/3600 seconds]
Best trial: 8. Best value: 0.606497:  37%|###6      | 11/30 [00:37<00:38,  2.03s/it, 33.90/3600 seconds]
Best trial: 8. Best value: 0.606497:  37%|###6      | 11/30 [00:37<00:38,  2.03s/it, 37.46/3600 seconds]
Best trial: 8. Best value: 0.606497:  37%|###6      | 11/30 [00:40<00:38,  2.03s/it, 37.46/3600 seconds]
Best trial: 8. Best value: 0.606497:  40%|####      | 12/30 [00:40<00:44,  2.48s/it, 37.46/3600 seconds]
Best trial: 8. Best value: 0.606497:  40%|####      | 12/30 [00:40<00:44,  2.48s/it, 40.96/3600 seconds]
Best trial: 8. Best value: 0.606497:  40%|####      | 12/30 [00:43<00:44,  2.48s/it, 40.96/3600 seconds]
Best trial: 8. Best value: 0.606497:  43%|####3     | 13/30 [00:43<00:41,  2.41s/it, 40.96/3600 seconds]
Best trial: 8. Best value: 0.606497:  43%|####3     | 13/30 [00:43<00:41,  2.41s/it, 43.22/3600 seconds]
Best trial: 8. Best value: 0.606497:  43%|####3     | 13/30 [00:45<00:41,  2.41s/it, 43.22/3600 seconds]
Best trial: 8. Best value: 0.606497:  47%|####6     | 14/30 [00:45<00:37,  2.35s/it, 43.22/3600 seconds]
Best trial: 8. Best value: 0.606497:  47%|####6     | 14/30 [00:45<00:37,  2.35s/it, 45.41/3600 seconds]
Best trial: 8. Best value: 0.606497:  47%|####6     | 14/30 [00:51<00:37,  2.35s/it, 45.41/3600 seconds]
Best trial: 8. Best value: 0.606497:  50%|#####     | 15/30 [00:51<00:51,  3.42s/it, 45.41/3600 seconds]
Best trial: 8. Best value: 0.606497:  50%|#####     | 15/30 [00:51<00:51,  3.42s/it, 51.32/3600 seconds]
Best trial: 8. Best value: 0.606497:  50%|#####     | 15/30 [00:52<00:51,  3.42s/it, 51.32/3600 seconds]
Best trial: 8. Best value: 0.606497:  53%|#####3    | 16/30 [00:52<00:36,  2.61s/it, 51.32/3600 seconds]
Best trial: 8. Best value: 0.606497:  53%|#####3    | 16/30 [00:52<00:36,  2.61s/it, 52.06/3600 seconds]
Best trial: 8. Best value: 0.606497:  53%|#####3    | 16/30 [00:52<00:36,  2.61s/it, 52.06/3600 seconds]
Best trial: 8. Best value: 0.606497:  57%|#####6    | 17/30 [00:52<00:25,  1.95s/it, 52.06/3600 seconds]
Best trial: 8. Best value: 0.606497:  57%|#####6    | 17/30 [00:52<00:25,  1.95s/it, 52.46/3600 seconds]
Best trial: 8. Best value: 0.606497:  57%|#####6    | 17/30 [00:56<00:25,  1.95s/it, 52.46/3600 seconds]
Best trial: 8. Best value: 0.606497:  60%|######    | 18/30 [00:56<00:31,  2.65s/it, 52.46/3600 seconds]
Best trial: 8. Best value: 0.606497:  60%|######    | 18/30 [00:56<00:31,  2.65s/it, 56.74/3600 seconds]
Best trial: 8. Best value: 0.606497:  60%|######    | 18/30 [00:57<00:31,  2.65s/it, 56.74/3600 seconds]
Best trial: 8. Best value: 0.606497:  63%|######3   | 19/30 [00:57<00:22,  2.09s/it, 56.74/3600 seconds]
Best trial: 8. Best value: 0.606497:  63%|######3   | 19/30 [00:57<00:22,  2.09s/it, 57.52/3600 seconds]
Best trial: 8. Best value: 0.606497:  63%|######3   | 19/30 [00:59<00:22,  2.09s/it, 57.52/3600 seconds]
Best trial: 8. Best value: 0.606497:  67%|######6   | 20/30 [00:59<00:20,  2.08s/it, 57.52/3600 seconds]
Best trial: 8. Best value: 0.606497:  67%|######6   | 20/30 [00:59<00:20,  2.08s/it, 59.58/3600 seconds]
Best trial: 8. Best value: 0.606497:  67%|######6   | 20/30 [01:05<00:20,  2.08s/it, 59.58/3600 seconds]
Best trial: 8. Best value: 0.606497:  70%|#######   | 21/30 [01:05<00:27,  3.11s/it, 59.58/3600 seconds]
Best trial: 8. Best value: 0.606497:  70%|#######   | 21/30 [01:05<00:27,  3.11s/it, 65.09/3600 seconds]
Best trial: 8. Best value: 0.606497:  70%|#######   | 21/30 [01:07<00:27,  3.11s/it, 65.09/3600 seconds]
Best trial: 8. Best value: 0.606497:  73%|#######3  | 22/30 [01:07<00:22,  2.78s/it, 65.09/3600 seconds]
Best trial: 8. Best value: 0.606497:  73%|#######3  | 22/30 [01:07<00:22,  2.78s/it, 67.10/3600 seconds]
Best trial: 8. Best value: 0.606497:  73%|#######3  | 22/30 [01:09<00:22,  2.78s/it, 67.10/3600 seconds]
Best trial: 8. Best value: 0.606497:  77%|#######6  | 23/30 [01:09<00:18,  2.63s/it, 67.10/3600 seconds]
Best trial: 8. Best value: 0.606497:  77%|#######6  | 23/30 [01:09<00:18,  2.63s/it, 69.37/3600 seconds]
Best trial: 8. Best value: 0.606497:  77%|#######6  | 23/30 [01:09<00:18,  2.63s/it, 69.37/3600 seconds]
Best trial: 8. Best value: 0.606497:  80%|########  | 24/30 [01:09<00:12,  2.01s/it, 69.37/3600 seconds]
Best trial: 8. Best value: 0.606497:  80%|########  | 24/30 [01:09<00:12,  2.01s/it, 69.93/3600 seconds]
Best trial: 8. Best value: 0.606497:  80%|########  | 24/30 [01:10<00:12,  2.01s/it, 69.93/3600 seconds]
Best trial: 8. Best value: 0.606497:  83%|########3 | 25/30 [01:10<00:08,  1.62s/it, 69.93/3600 seconds]
Best trial: 8. Best value: 0.606497:  83%|########3 | 25/30 [01:10<00:08,  1.62s/it, 70.66/3600 seconds]
Best trial: 8. Best value: 0.606497:  83%|########3 | 25/30 [01:13<00:08,  1.62s/it, 70.66/3600 seconds]
Best trial: 8. Best value: 0.606497:  87%|########6 | 26/30 [01:13<00:08,  2.03s/it, 70.66/3600 seconds]
Best trial: 8. Best value: 0.606497:  87%|########6 | 26/30 [01:13<00:08,  2.03s/it, 73.65/3600 seconds]
Best trial: 8. Best value: 0.606497:  87%|########6 | 26/30 [01:21<00:08,  2.03s/it, 73.65/3600 seconds]
Best trial: 8. Best value: 0.606497:  90%|######### | 27/30 [01:21<00:11,  3.92s/it, 73.65/3600 seconds]
Best trial: 8. Best value: 0.606497:  90%|######### | 27/30 [01:21<00:11,  3.92s/it, 81.98/3600 seconds]
Best trial: 8. Best value: 0.606497:  90%|######### | 27/30 [01:23<00:11,  3.92s/it, 81.98/3600 seconds]
Best trial: 8. Best value: 0.606497:  93%|#########3| 28/30 [01:23<00:06,  3.07s/it, 81.98/3600 seconds]
Best trial: 8. Best value: 0.606497:  93%|#########3| 28/30 [01:23<00:06,  3.07s/it, 83.07/3600 seconds]
Best trial: 8. Best value: 0.606497:  93%|#########3| 28/30 [01:23<00:06,  3.07s/it, 83.07/3600 seconds]
Best trial: 8. Best value: 0.606497:  97%|#########6| 29/30 [01:23<00:02,  2.30s/it, 83.07/3600 seconds]
Best trial: 8. Best value: 0.606497:  97%|#########6| 29/30 [01:23<00:02,  2.30s/it, 83.58/3600 seconds]
Best trial: 8. Best value: 0.606497:  97%|#########6| 29/30 [01:23<00:02,  2.30s/it, 83.58/3600 seconds]
Best trial: 8. Best value: 0.606497: 100%|##########| 30/30 [01:23<00:00,  1.70s/it, 83.58/3600 seconds]
Best trial: 8. Best value: 0.606497: 100%|##########| 30/30 [01:23<00:00,  1.70s/it, 83.87/3600 seconds]
Best trial: 8. Best value: 0.606497: 100%|##########| 30/30 [01:23<00:00,  2.80s/it, 83.87/3600 seconds]
[Optuna] CatBoost best AUC: 0.6065
[Optuna] CatBoost best params: {'iterations': 148, 'depth': 6, 'learning_rate': 0.011240768803005551, 'subsample': 0.9637281608315128, 'l2_leaf_reg': 2.587799816000169}

[4/6] Training final models on train+val...

[5/6] Training ensemble models...

[6/6] Model comparison...
--------------------------------------------------------------------------------
Model                Accuracy     ROC AUC     
--------------------------------------------------------------------------------
XGBoost              0.4695       0.4829      
LightGBM             0.4718       0.4626      
CatBoost             0.4554       0.4823      
Voting Ensemble      0.4577       0.4754      
Stacking Ensemble    0.4671       0.4646      
--------------------------------------------------------------------------------

*** BEST MODEL: XGBOOST ***
   Accuracy: 0.4695
   ROC AUC: 0.4829

Traceback (most recent call last):
  File "C:\AI\myAssistent\scripts\train_ensemble_optimized.py", line 315, in <module>
    main()
    ~~~~^^
  File "C:\AI\myAssistent\scripts\train_ensemble_optimized.py", line 306, in main
    print(f"\u2705 Model saved: {model_path}")
    ~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\nikita\AppData\Local\Programs\Python\Python313\Lib\encodings\cp1251.py", line 19, in encode
    return codecs.charmap_encode(input,self.errors,encoding_table)[0]
           ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
UnicodeEncodeError: 'charmap' codec can't encode character '\u2705' in position 0: character maps to <undefined>
